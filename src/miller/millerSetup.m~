function [inputData,outputData,] = millerSetup(motionArray,eventArray)
%% get the NN features & outputs
fs=1000;
features=zeros(size(motionArray,1),42,size(motionArray,3),size(motionArray,4));
stanceL=zeros(size(motionArray,1),size(motionArray,3),size(motionArray,4));
stanceR=zeros(size(motionArray,1),size(motionArray,3),size(motionArray,4));
for j=1:size(motionArray,3)
    for k=1:size(motionArray,4)
        [features(:,:,j,k), labels] = getNNFeatures(motionArray(:,:,j,k),markersToBeUsed,fs);
        [stanceL(:,j,k),stanceR(:,j,k)] = getStanceFromEvents(eventArray(:,:,j,k),eventsToBeUsed);
    end
end

%% parse timeseries into sequences of 200ms, with the label being the one from the mid-sample
%Random pick 200 time-samples (per subject & trial) that have at least 200ms preceding and 200ms
%after
M=200;
T=round(.2*fs); %200ms in samples
i=randi(size(features,1)-2*T,M,1)+T;
inputData=zeros(length(i),size(motionArray,3),size(motionArray,4),2*T+1,size(features,2));
outputData=zeros(length(i),size(motionArray,3),size(motionArray,4),2);
for j=1:length(i)
    for l=1:size(motionArray,4)
        for k=1:size(motionArray,3)
            inputData(j,k,l,:,:)=features(i(j)-T:i(j)+T,:,k,l);
            outputData(j,k,l,:)=[stanceL(i(j),k,l), stanceR(i(j),k,l)];
        end
    end
end

s=size(inputData);
inputData=reshape(inputData,prod(s(1:3)),prod(s(4:5)));
outputData=reshape(outputData,prod(s(1:3)),2);

end

